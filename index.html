<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Password Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            background-image: url('https://placehold.co/1920x1080/e5e7eb/6b7280?text=Office+Background');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        .message-box {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #22c55e;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            z-index: 1000;
        }
        .message-box.show {
            opacity: 1;
        }
        .math-problem {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="message-box" id="messageBox"></div>

    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-2xl transform transition-all duration-300 hover:shadow-2xl">
        <!-- Main title and description -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Jargon-Based Password Generator</h1>
            <p class="text-gray-500 text-lg">Generate strong, memorable passwords using business jargon.</p>
        </div>

        <!-- Password output and copy button -->
        <div class="flex items-center space-x-4 mb-8 bg-gray-50 rounded-lg p-4 shadow-inner">
            <input type="text" id="passwordOutput" readonly class="flex-1 text-2xl font-mono text-gray-700 bg-transparent border-none outline-none truncate" value="Click 'Generate' to begin">
            <button id="copyButton" class="p-3 bg-blue-500 text-white rounded-lg shadow-md hover:bg-blue-600 transition-colors duration-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
            </button>
        </div>
        
        <!-- Password length and function input -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
                <label for="passwordLength" class="block text-gray-700 text-sm font-medium mb-2">
                    Password Length: <span id="lengthValue">12</span>
                </label>
                <input type="range" id="passwordLength" min="10" max="15" value="12" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
            </div>
            <div>
                <label for="userFunction" class="block text-gray-700 text-sm font-medium mb-2">
                    Your Function
                </label>
                <select id="userFunction" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-colors duration-300">
                    <option value="general">General Business</option>
                    <option value="management">Management</option>
                    <option value="software">Software</option>
                    <option value="mechanical">Mechanical</option>
                    <option value="civil">Civil</option>
                    <option value="electrical">Electrical</option>
                    <option value="finance">Finance</option>
                    <option value="sales">Sales</option>
                    <option value="marketing">Marketing</option>
                    <option value="hr">Human Resources</option>
                </select>
            </div>
        </div>

        <!-- Math problem security section -->
        <div id="mathProblemSection" class="math-problem bg-gray-50 rounded-lg p-4 mb-6 transition-all duration-300 ease-in-out">
            <label for="mathAnswer" id="mathQuestion" class="block text-gray-700 text-sm font-medium mb-2">
                Solve the problem to generate your password:
            </label>
            <div class="flex items-center space-x-2">
                <input type="text" id="mathAnswer" class="flex-1 p-2 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-300">
                <button id="submitAnswerButton" class="py-2 px-4 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-600 transition-colors duration-300">
                    Submit
                </button>
            </div>
        </div>

        <!-- Generate button -->
        <button id="generateButton" class="w-full py-4 bg-blue-600 text-white font-bold text-lg rounded-xl shadow-lg hover:bg-blue-700 transition-all duration-300 transform hover:-translate-y-1">
            Generate Password
        </button>
    </div>

    <script>
        // DOM element references
        const passwordOutput = document.getElementById('passwordOutput');
        const passwordLengthInput = document.getElementById('passwordLength');
        const lengthValueSpan = document.getElementById('lengthValue');
        const userFunctionSelect = document.getElementById('userFunction');
        const generateButton = document.getElementById('generateButton');
        const copyButton = document.getElementById('copyButton');
        const messageBox = document.getElementById('messageBox');
        const mathProblemSection = document.getElementById('mathProblemSection');
        const mathQuestionLabel = document.getElementById('mathQuestion');
        const mathAnswerInput = document.getElementById('mathAnswer');
        const submitAnswerButton = document.getElementById('submitAnswerButton');

        let lastPassword = '';
        let currentAnswer = 0;

        // Data structure for function-specific jargon words
        const jargonWordsByFunction = {
            general: ['Agile', 'Synergy', 'Metrics', 'Team', 'Lead', 'Flow', 'Data', 'Goal', 'Tech', 'Code', 'Sync', 'Task', 'Dev'],
            management: ['Plan', 'Lead', 'Sync', 'Risk', 'KPIs', 'Agile', 'Goal', 'Role'],
            software: ['Code', 'Flow', 'Data', 'Dev', 'Test', 'Bug', 'API', 'App'],
            mechanical: ['Tech', 'Design', 'Part', 'Tool', 'Spec', 'Gear', 'Unit'],
            civil: ['Plan', 'Spec', 'Plot', 'Site', 'Load', 'Build'],
            electrical: ['Wire', 'Volt', 'Fuse', 'Plug', 'Node', 'Chip', 'Grid'],
            finance: ['Fund', 'Cash', 'Rate', 'Loan', 'Cost', 'Tax'],
            sales: ['Lead', 'Sale', 'Deal', 'CRM', 'Quota', 'Goal'],
            marketing: ['Brand', 'Lead', 'Data', 'SEO', 'Ad', 'Funnel'],
            hr: ['Hire', 'Team', 'Role', 'Goal', 'Pay', 'Perk']
        };
        
        const allowedSymbols = ['!', '@', '#', '$', '%', '&'];
        const allowedPadChars = "0123456789" + allowedSymbols.join('');

        // A map for converting letters to numbers and symbols
        const letterToReplacementMap = {
            'a': ['4', '@'], 'b': ['8'], 'e': ['3'], 'g': ['9'], 'i': ['1', '!'], 'o': ['0'], 's': ['5', '$']
        };
        
        /**
         * Selects a random element from an array.
         * @param {Array} arr The array to choose from.
         * @returns {*} A random element from the array.
         */
        function getRandomElement(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        /**
         * Processes a word by selectively replacing characters with numbers or symbols.
         * @param {string} word The word to process.
         * @param {number} currentSpecialCharCount The current count of special characters and numbers.
         * @returns {{processedWord: string, newSpecialCharCount: number}} An object containing the processed word and the updated count.
         */
        function processWord(word, currentSpecialCharCount) {
            let processed = '';
            let replacementCount = currentSpecialCharCount;

            for (const char of word) {
                const lowerChar = char.toLowerCase();
                const replacements = letterToReplacementMap[lowerChar];
                
                // Only replace if a replacement exists and we haven't hit the limit.
                if (replacements && replacementCount < 2 && Math.random() < 0.5) {
                    const replacement = getRandomElement(replacements);
                    processed += replacement;
                    replacementCount++;
                } else {
                    processed += char;
                }
            }
            return { processedWord: processed, newSpecialCharCount: replacementCount };
        }

        /**
         * Generates a password based on two jargon words, with replacements and a separator.
         */
        function generateJargonPassword() {
            const desiredLength = parseInt(passwordLengthInput.value, 10);
            const selectedFunction = userFunctionSelect.value;
            const wordsForFunction = jargonWordsByFunction[selectedFunction];
            
            let finalPassword = '';
            let attempts = 0;
            const maxAttempts = 50;
            
            // Loop to ensure the new password is not the same as the last one
            do {
                if (attempts > maxAttempts) {
                    console.warn('Could not generate a unique password after several attempts.');
                    break;
                }
                
                // Select two random jargon words based on the function
                let word1 = getRandomElement(wordsForFunction);
                let word2;
                do {
                    word2 = getRandomElement(wordsForFunction);
                } while (word1 === word2); // Ensure the words are different

                let replacementCount = 0;
                
                const result1 = processWord(word1, replacementCount);
                const processedWord1 = result1.processedWord;
                replacementCount = result1.newSpecialCharCount;
                
                const separator = getRandomElement(allowedSymbols);
                
                const result2 = processWord(word2, replacementCount);
                const processedWord2 = result2.processedWord;
                
                finalPassword = processedWord1 + separator + processedWord2;
                
                // Pad or trim the password to match the desired length.
                while (finalPassword.length < desiredLength) {
                    finalPassword += getRandomElement(allowedPadChars.split(''));
                }
                
                if (finalPassword.length > desiredLength) {
                    finalPassword = finalPassword.substring(0, desiredLength);
                }

                attempts++;
            } while (finalPassword === lastPassword);

            passwordOutput.value = finalPassword;
            lastPassword = finalPassword;
        }

        /**
         * Function to generate and display a new math problem.
         */
        function generateMathProblem() {
            const num1 = Math.floor(Math.random() * 10) + 1; // Number between 1 and 10
            const num2 = Math.floor(Math.random() * 10) + 1; // Number between 1 and 10
            const operation = Math.random() < 0.5 ? '+' : '*';

            let question = '';
            if (operation === '+') {
                question = `What is ${num1} + ${num2}?`;
                currentAnswer = num1 + num2;
            } else {
                question = `What is ${num1} x ${num2}?`;
                currentAnswer = num1 * num2;
            }

            mathQuestionLabel.textContent = question;
            mathAnswerInput.value = '';
            mathProblemSection.style.display = 'block';
            generateButton.style.display = 'none';
        }

        /**
         * Function to check the user's answer to the math problem.
         */
        function checkAnswer() {
            const userAnswer = parseInt(mathAnswerInput.value, 10);

            if (userAnswer === currentAnswer) {
                mathProblemSection.style.display = 'none';
                generateButton.style.display = 'block';
                generateJargonPassword();
            } else {
                showMessage("Incorrect answer. Please try again.");
                generateMathProblem();
            }
        }
        
        /**
         * Function to copy password to clipboard.
         */
        function copyPasswordToClipboard() {
            passwordOutput.select();
            passwordOutput.setSelectionRange(0, 99999); 

            try {
                document.execCommand('copy');
                showMessage("Password copied to clipboard!");
            } catch (err) {
                showMessage("Failed to copy password. Please copy it manually.");
                console.error('Copy to clipboard failed: ', err);
            }
        }

        /**
         * Function to show a temporary message box.
         * @param {string} message The message to display.
         */
        function showMessage(message) {
            messageBox.textContent = message;
            messageBox.classList.add('show');
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, 3000); 
        }

        // Event listeners
        passwordLengthInput.addEventListener('input', (event) => {
            lengthValueSpan.textContent = event.target.value;
            generateJargonPassword();
        });

        generateButton.addEventListener('click', generateMathProblem);
        submitAnswerButton.addEventListener('click', checkAnswer);
        copyButton.addEventListener('click', copyPasswordToClipboard);
        userFunctionSelect.addEventListener('change', generateJargonPassword);

        // Generate a password on page load
        window.onload = generateJargonPassword;
    </script>

</body>
</html>
